<html>
<head>

   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">


</head>

<body>

  <div id="demo">


    <div class="row">
      <div class = "col s12 m7">
        <div class="panel-heading">
          <h3>Add an Message</h3>
        </div>

        <form>

          <input class ="input-field" placeholder="Enter your Name" v-model="newGuest.name"><br><br>

          <textarea placeholder="Leave a Message" v-model="newGuest.message"></textarea><br><br>

          <button v-on:click="addGuest">Submit</button>

        </form>

      </div>

      <div class="col s12 m5">
        <div class="card-panel teal" v-for="guest in guests">
          <span class="white-text">
          <span class="card-title">{{guest.name}}</span><br>
          Message: <span>{{guest.message}}</span>
          </span>
        </div>
      </div>

    </div>



  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>

  <script src="http://cdnjs.cloudflare.com/ajax/libs/vue/1.0.17/vue.min.js"></script>

<!----------------------------------------------Vue JS-->

  <script type="text/javaScript">

  var apiURL = 'http://nodeguestbook.herokuapp.com/api/data'

  var demo = new Vue({

    el: '#demo',

    data: {

      guests: null,

      newGuest: {
        name:'',
        message:''
        }

      },

    created: function () {
      this.fetchData()
    },


    methods: {
      fetchData: function () {
        var xhr = new XMLHttpRequest()
        var self = this
        xhr.open('GET', apiURL)
        xhr.onload = function () {
          self.guests = JSON.parse(xhr.responseText)
          self.guests.reverse()
        }
        xhr.send()
      },

      addGuest: function () {

        var xhp = new XMLHttpRequest()
        xhp.open('POST', apiURL)
        xhp.setRequestHeader("Content-type", "application/json");
        xhp.send(JSON.stringify(this.newGuest))

        this.newGuest.name = ''
        this.newGuest.message = ''

      }
    }

  })
  </script>
</body>


</html>
